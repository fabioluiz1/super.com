[tools]
node = "24.7.0"
python = "3.12"

[tasks."install:backend"]
description = "Install backend dependencies"
dir = "backend"
run = "uv sync"

[tasks."install:frontend"]
description = "Install frontend dependencies"
dir = "frontend"
run = "npm install"

[tasks."lint:backend"]
description = "Run ruff linter on Python files"
dir = "backend"
run = "uv run ruff check ."

[tasks."format:backend"]
description = "Auto-format Python files with ruff"
dir = "backend"
run = "uv run ruff format ."

[tasks."format:backend:check"]
description = "Check Python formatting with ruff"
dir = "backend"
run = "uv run ruff format --check ."

[tasks."typecheck:backend"]
description = "Run mypy static type analysis"
dir = "backend"
run = "uv run mypy src/ tests/"

[tasks."test:backend"]
description = "Run pytest with coverage"
dir = "backend"
run = "uv run pytest"

[tasks."dev:backend"]
description = "Run FastAPI dev server with hot reload"
dir = "backend"
run = "uv run uvicorn app.main:app --reload --app-dir src"

[tasks."db:migrate"]
description = "Run pending database migrations"
dir = "backend"
run = "uv run alembic upgrade head"

[tasks."db:rollback"]
description = "Rollback last database migration"
dir = "backend"
run = "uv run alembic downgrade -1"

[tasks."db:generate"]
description = "Generate new migration from model changes"
dir = "backend"
run = "uv run alembic revision --autogenerate -m"

[tasks."lint:sass"]
description = "Run stylelint on Sass files"
dir = "frontend"
run = "npm run lint:sass"

[tasks.lint]
description = "Run ESLint on TypeScript"
dir = "frontend"
run = "npm run lint"

[tasks.format]
description = "Auto-format with Prettier"
dir = "frontend"
run = "npm run format"

[tasks."format:check"]
description = "Check formatting with Prettier"
dir = "frontend"
run = "npm run format:check"

[tasks.pre-commit]
description = "Run all checks (used by git pre-commit hook)"
depends = ["lint:sass", "lint", "format:check", "lint:backend", "format:backend:check", "typecheck:backend"]

[tasks.setup]
description = "Install git hooks"
run = "mise generate git-pre-commit --write"
